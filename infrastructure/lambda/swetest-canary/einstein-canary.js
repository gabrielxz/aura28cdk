"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.handler = void 0;
const handler = async () => {
    console.info('Starting Einstein canary test for Swiss Ephemeris layer');
    const testResult = {
        success: false,
        error: null,
        houseCount: 0,
        executionTime: 0,
    };
    const startTime = Date.now();
    try {
        // Import Swiss Ephemeris - this validates the layer is working
        const swisseph = require('swisseph');
        // Set ephemeris path
        process.env.SE_EPHE_PATH = '/opt/nodejs/node_modules/swisseph/ephe';
        swisseph.swe_set_ephe_path(process.env.SE_EPHE_PATH);
        // Albert Einstein birth data
        const birthDate = new Date('1879-03-14T10:30:00Z'); // UTC time
        const julianDay = swisseph.swe_julday(birthDate.getUTCFullYear(), birthDate.getUTCMonth() + 1, birthDate.getUTCDate(), birthDate.getUTCHours() + birthDate.getUTCMinutes() / 60, swisseph.SE_GREG_CAL);
        // Ulm, Germany coordinates
        const latitude = 48.4;
        const longitude = 9.99;
        // Calculate houses using Placidus system
        const houses = swisseph.swe_houses(julianDay, latitude, longitude, 'P');
        if (!houses || !houses.house || houses.house.length < 12) {
            throw new Error('House calculation failed - invalid result structure');
        }
        // Validate we got 12 houses
        const houseCount = houses.house.filter((h) => h !== undefined).length;
        if (houseCount < 12) {
            throw new Error(`Only ${houseCount} houses calculated, expected 12`);
        }
        // Calculate Sun position for additional validation
        const sunResult = swisseph.swe_calc_ut(julianDay, swisseph.SE_SUN, swisseph.SEFLG_SPEED);
        if (!sunResult || typeof sunResult.longitude !== 'number') {
            throw new Error('Sun calculation failed');
        }
        // Validate Sun is approximately in Pisces (330-360 or 0-30 degrees)
        const sunLongitude = sunResult.longitude;
        const expectedSign = 'Pisces';
        const signStart = 330;
        const signEnd = 360;
        if (sunLongitude < signStart || sunLongitude > signEnd) {
            console.warn(`Sun position validation: ${sunLongitude}Â° (may not be in ${expectedSign} as expected)`);
        }
        testResult.success = true;
        testResult.houseCount = houseCount;
        console.info('Einstein canary test PASSED', {
            houseCount,
            firstHouse: houses.house[0],
            sunLongitude,
        });
    }
    catch (error) {
        testResult.error = error instanceof Error ? error.message : String(error);
        console.error('Einstein canary test FAILED:', testResult.error);
    }
    testResult.executionTime = Date.now() - startTime;
    // Send metric to CloudWatch (using dynamic import to avoid bundling issues)
    try {
        // @ts-ignore - Dynamic import for runtime
        const { CloudWatchClient, PutMetricDataCommand } = require('@aws-sdk/client-cloudwatch');
        const cloudwatch = new CloudWatchClient({});
        await cloudwatch.send(new PutMetricDataCommand({
            Namespace: 'Aura28/Canary',
            MetricData: [
                {
                    MetricName: 'SwissEphemerisLayerHealth',
                    Value: testResult.success ? 1 : 0,
                    Unit: 'Count',
                    Timestamp: new Date(),
                    Dimensions: [
                        {
                            Name: 'Environment',
                            Value: process.env.ENVIRONMENT || 'unknown',
                        },
                        {
                            Name: 'Test',
                            Value: 'Einstein',
                        },
                    ],
                },
                {
                    MetricName: 'SwissEphemerisExecutionTime',
                    Value: testResult.executionTime,
                    Unit: 'Milliseconds',
                    Timestamp: new Date(),
                },
            ],
        }));
    }
    catch (metricError) {
        console.error('Failed to send CloudWatch metric:', metricError);
    }
    // Throw error if test failed to trigger alarm
    if (!testResult.success) {
        throw new Error(`Canary test failed: ${testResult.error}`);
    }
};
exports.handler = handler;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWluc3RlaW4tY2FuYXJ5LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiZWluc3RlaW4tY2FuYXJ5LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFPLE1BQU0sT0FBTyxHQUFHLEtBQUssSUFBbUIsRUFBRTtJQUMvQyxPQUFPLENBQUMsSUFBSSxDQUFDLHlEQUF5RCxDQUFDLENBQUM7SUFFeEUsTUFBTSxVQUFVLEdBQUc7UUFDakIsT0FBTyxFQUFFLEtBQUs7UUFDZCxLQUFLLEVBQUUsSUFBcUI7UUFDNUIsVUFBVSxFQUFFLENBQUM7UUFDYixhQUFhLEVBQUUsQ0FBQztLQUNqQixDQUFDO0lBRUYsTUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDO0lBRTdCLElBQUksQ0FBQztRQUNILCtEQUErRDtRQUMvRCxNQUFNLFFBQVEsR0FBRyxPQUFPLENBQUMsVUFBVSxDQUFDLENBQUM7UUFFckMscUJBQXFCO1FBQ3JCLE9BQU8sQ0FBQyxHQUFHLENBQUMsWUFBWSxHQUFHLHdDQUF3QyxDQUFDO1FBQ3BFLFFBQVEsQ0FBQyxpQkFBaUIsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBRXJELDZCQUE2QjtRQUM3QixNQUFNLFNBQVMsR0FBRyxJQUFJLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDLENBQUMsV0FBVztRQUMvRCxNQUFNLFNBQVMsR0FBRyxRQUFRLENBQUMsVUFBVSxDQUNuQyxTQUFTLENBQUMsY0FBYyxFQUFFLEVBQzFCLFNBQVMsQ0FBQyxXQUFXLEVBQUUsR0FBRyxDQUFDLEVBQzNCLFNBQVMsQ0FBQyxVQUFVLEVBQUUsRUFDdEIsU0FBUyxDQUFDLFdBQVcsRUFBRSxHQUFHLFNBQVMsQ0FBQyxhQUFhLEVBQUUsR0FBRyxFQUFFLEVBQ3hELFFBQVEsQ0FBQyxXQUFXLENBQ3JCLENBQUM7UUFFRiwyQkFBMkI7UUFDM0IsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDO1FBQ3RCLE1BQU0s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LENBQUMsQ0FBQyxDQUFDLENBQUM7b0JBQ2pDLElBQUksRUFBRSxPQUFPO29CQUNiLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRTtvQkFDckIsVUFBVSxFQUFFO3dCQUNWOzRCQUNFLElBQUksRUFBRSxhQUFhOzRCQUNuQixLQUFLLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxXQUFXLElBQUksU0FBUzt5QkFDNUM7d0JBQ0Q7NEJBQ0UsSUFBSSxFQUFFLE1BQU07NEJBQ1osS0FBSyxFQUFFLFVBQVU7eUJBQ2xCO3FCQUNGO2lCQUNGO2dCQUNEO29CQUNFLFVBQVUsRUFBRSw2QkFBNkI7b0JBQ3pDLEtBQUssRUFBRSxVQUFVLENBQUMsYUFBYTtvQkFDL0IsSUFBSSxFQUFFLGNBQWM7b0JBQ3BCLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRTtpQkFDdEI7YUFDRjtTQUNGLENBQUMsQ0FDSCxDQUFDO0lBQ0osQ0FBQztJQUFDLE9BQU8sV0FBVyxFQUFFLENBQUM7UUFDckIsT0FBTyxDQUFDLEtBQUssQ0FBQyxtQ0FBbUMsRUFBRSxXQUFXLENBQUMsQ0FBQztJQUNsRSxDQUFDO0lBRUQsOENBQThDO0lBQzlDLElBQUksQ0FBQyxVQUFVLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDeEIsTUFBTSxJQUFJLEtBQUssQ0FBQyx1QkFBdUIsVUFBVSxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUM7SUFDN0QsQ0FBQztBQUNILENBQUMsQ0FBQztBQS9IVyxRQUFBLE9BQU8sV0ErSGxCIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IGhhbmRsZXIgPSBhc3luYyAoKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gIGNvbnNvbGUuaW5mbygnU3RhcnRpbmcgRWluc3RlaW4gY2FuYXJ5IHRlc3QgZm9yIFN3aXNzIEVwaGVtZXJpcyBsYXllcicpO1xuXG4gIGNvbnN0IHRlc3RSZXN1bHQgPSB7XG4gICAgc3VjY2VzczogZmFsc2UsXG4gICAgZXJyb3I6IG51bGwgYXMgc3RyaW5nIHwgbnVsbCxcbiAgICBob3VzZUNvdW50OiAwLFxuICAgIGV4ZWN1dGlvblRpbWU6IDAsXG4gIH07XG5cbiAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcblxuICB0cnkge1xuICAgIC8vIEltcG9ydCBTd2lzcyBFcGhlbWVyaXMgLSB0aGlzIHZhbGlkYXRlcyB0aGUgbGF5ZXIgaXMgd29ya2luZ1xuICAgIGNvbnN0IHN3aXNzZXBoID0gcmVxdWlyZSgnc3dpc3NlcGgnKTtcblxuICAgIC8vIFNldCBlcGhlbWVyaXMgcGF0aFxuICAgIHByb2Nlc3MuZW52LlNFX0VQSEVfUEFUSCA9ICcvb3B0L25vZGVqcy9ub2RlX21vZHVsZXMvc3dpc3NlcGgvZXBoZSc7XG4gICAgc3dpc3NlcGguc3dlX3NldF9lcGhlX3BhdGgocHJvY2Vzcy5lbnYuU0VfRVBIRV9QQVRIKTtcblxuICAgIC8vIEFsYmVydCBFaW5zdGVpbiBiaXJ0aCBkYXRhXG4gICAgY29uc3QgYmlydGhEYXRlID0gbmV3IERhdGUoJzE4NzktMDMtMTRUMTA6MzA6MDBaJyk7IC8vIFVUQyB0aW1lXG4gICAgY29uc3QganVsaWFuRGF5ID0gc3dpc3NlcGguc3dlX2p1bGRheShcbiAgICAgIGJpcnRoRGF0ZS5nZXRVVENGdWxsWWVhcigpLFxuICAgICAgYmlydGhEYXRlLmdldFVUQ01vbnRoKCkgKyAxLFxuICAgICAgYmlydGhEYXRlLmdldFVUQ0RhdGUoKSxcbiAgICAgIGJpcnRoRGF0ZS5nZXRVVENIb3VycygpICsgYmlydGhEYXRlLmdldFVUQ01pbnV0ZXMoKSAvIDYwLFxuICAgICAgc3dpc3NlcGguU0VfR1JFR19DQUwsXG4gICAgKTtcblxuICAgIC8vIFVsbSwgR2VybWFueSBjb29yZGluYXRlc1xuICAgIGNvbnN0IGxhdGl0dWRlID0gNDguNDtcbiAgICBjb25zdCBsb25naXR1ZGUgPSA5Ljk5O1xuXG4gICAgLy8gQ2FsY3VsYXRlIGhvdXNlcyB1c2luZyBQbGFjaWR1cyBzeXN0ZW1cbiAgICBjb25zdCBob3VzZXMgPSBzd2lzc2VwaC5zd2VfaG91c2VzKFxuICAgICAganVsaWFuRGF5LFxuICAgICAgbGF0aXR1ZGUsXG4gICAgICBsb25naXR1ZGUsXG4gICAgICAnUCcsIC8vIFBsYWNpZHVzXG4gICAgKTtcblxuICAgIGlmICghaG91c2VzIHx8ICFob3VzZXMuaG91c2UgfHwgaG91c2VzLmhvdXNlLmxlbmd0aCA8IDEyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0hvdXNlIGNhbGN1bGF0aW9uIGZhaWxlZCAtIGludmFsaWQgcmVzdWx0IHN0cnVjdHVyZScpO1xuICAgIH1cblxuICAgIC8vIFZhbGlkYXRlIHdlIGdvdCAxMiBob3VzZXNcbiAgICBjb25zdCBob3VzZUNvdW50ID0gaG91c2VzLmhvdXNlLmZpbHRlcigoaDogbnVtYmVyKSA9PiBoICE9PSB1bmRlZmluZWQpLmxlbmd0aDtcbiAgICBpZiAoaG91c2VDb3VudCA8IDEyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYE9ubHkgJHtob3VzZUNvdW50fSBob3VzZXMgY2FsY3VsYXRlZCwgZXhwZWN0ZWQgMTJgKTtcbiAgICB9XG5cbiAgICAvLyBDYWxjdWxhdGUgU3VuIHBvc2l0aW9uIGZvciBhZGRpdGlvbmFsIHZhbGlkYXRpb25cbiAgICBjb25zdCBzdW5SZXN1bHQgPSBzd2lzc2VwaC5zd2VfY2FsY191dChqdWxpYW5EYXksIHN3aXNzZXBoLlNFX1NVTiwgc3dpc3NlcGguU0VGTEdfU1BFRUQpO1xuICAgIGlmICghc3VuUmVzdWx0IHx8IHR5cGVvZiBzdW5SZXN1bHQubG9uZ2l0dWRlICE9PSAnbnVtYmVyJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdTdW4gY2FsY3VsYXRpb24gZmFpbGVkJyk7XG4gICAgfVxuXG4gICAgLy8gVmFsaWRhdGUgU3VuIGlzIGFwcHJveGltYXRlbHkgaW4gUGlzY2VzICgzMzAtMzYwIG9yIDAtMzAgZGVncmVlcylcbiAgICBjb25zdCBzdW5Mb25naXR1ZGUgPSBzdW5SZXN1bHQubG9uZ2l0dWRlO1xuICAgIGNvbnN0IGV4cGVjdGVkU2lnbiA9ICdQaXNjZXMnO1xuICAgIGNvbnN0IHNpZ25TdGFydCA9IDMzMDtcbiAgICBjb25zdCBzaWduRW5kID0gMzYwO1xuXG4gICAgaWYgKHN1bkxvbmdpdHVkZSA8IHNpZ25TdGFydCB8fCBzdW5Mb25naXR1ZGUgPiBzaWduRW5kKSB7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgIGBTdW4gcG9zaXRpb24gdmFsaWRhdGlvbjogJHtzdW5Mb25naXR1ZGV9wrAgKG1heSBub3QgYmUgaW4gJHtleHBlY3RlZFNpZ259IGFzIGV4cGVjdGVkKWAsXG4gICAgICApO1xuICAgIH1cblxuICAgIHRlc3RSZXN1bHQuc3VjY2VzcyA9IHRydWU7XG4gICAgdGVzdFJlc3VsdC5ob3VzZUNvdW50ID0gaG91c2VDb3VudDtcbiAgICBjb25zb2xlLmluZm8oJ0VpbnN0ZWluIGNhbmFyeSB0ZXN0IFBBU1NFRCcsIHtcbiAgICAgIGhvdXNlQ291bnQsXG4gICAgICBmaXJzdEhvdXNlOiBob3VzZXMuaG91c2VbMF0sXG4gICAgICBzdW5Mb25naXR1ZGUsXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgdGVzdFJlc3VsdC5lcnJvciA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKTtcbiAgICBjb25zb2xlLmVycm9yKCdFaW5zdGVpbiBjYW5hcnkgdGVzdCBGQUlMRUQ6JywgdGVzdFJlc3VsdC5lcnJvcik7XG4gIH1cblxuICB0ZXN0UmVzdWx0LmV4ZWN1dGlvblRpbWUgPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuXG4gIC8vIFNlbmQgbWV0cmljIHRvIENsb3VkV2F0Y2ggKHVzaW5nIGR5bmFtaWMgaW1wb3J0IHRvIGF2b2lkIGJ1bmRsaW5nIGlzc3VlcylcbiAgdHJ5IHtcbiAgICAvLyBAdHMtaWdub3JlIC0gRHluYW1pYyBpbXBvcnQgZm9yIHJ1bnRpbWVcbiAgICBjb25zdCB7IENsb3VkV2F0Y2hDbGllbnQsIFB1dE1ldHJpY0RhdGFDb21tYW5kIH0gPSByZXF1aXJlKCdAYXdzLXNkay9jbGllbnQtY2xvdWR3YXRjaCcpO1xuICAgIGNvbnN0IGNsb3Vkd2F0Y2ggPSBuZXcgQ2xvdWRXYXRjaENsaWVudCh7fSk7XG5cbiAgICBhd2FpdCBjbG91ZHdhdGNoLnNlbmQoXG4gICAgICBuZXcgUHV0TWV0cmljRGF0YUNvbW1hbmQoe1xuICAgICAgICBOYW1lc3BhY2U6ICdBdXJhMjgvQ2FuYXJ5JyxcbiAgICAgICAgTWV0cmljRGF0YTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIE1ldHJpY05hbWU6ICdTd2lzc0VwaGVtZXJpc0xheWVySGVhbHRoJyxcbiAgICAgICAgICAgIFZhbHVlOiB0ZXN0UmVzdWx0LnN1Y2Nlc3MgPyAxIDogMCxcbiAgICAgICAgICAgIFVuaXQ6ICdDb3VudCcsXG4gICAgICAgICAgICBUaW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgICAgICBEaW1lbnNpb25zOiBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBOYW1lOiAnRW52aXJvbm1lbnQnLFxuICAgICAgICAgICAgICAgIFZhbHVlOiBwcm9jZXNzLmVudi5FTlZJUk9OTUVOVCB8fCAndW5rbm93bicsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBOYW1lOiAnVGVzdCcsXG4gICAgICAgICAgICAgICAgVmFsdWU6ICdFaW5zdGVpbicsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBdLFxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgTWV0cmljTmFtZTogJ1N3aXNzRXBoZW1lcmlzRXhlY3V0aW9uVGltZScsXG4gICAgICAgICAgICBWYWx1ZTogdGVzdFJlc3VsdC5leGVjdXRpb25UaW1lLFxuICAgICAgICAgICAgVW5pdDogJ01pbGxpc2Vjb25kcycsXG4gICAgICAgICAgICBUaW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgIH0pLFxuICAgICk7XG4gIH0gY2F0Y2ggKG1ldHJpY0Vycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHNlbmQgQ2xvdWRXYXRjaCBtZXRyaWM6JywgbWV0cmljRXJyb3IpO1xuICB9XG5cbiAgLy8gVGhyb3cgZXJyb3IgaWYgdGVzdCBmYWlsZWQgdG8gdHJpZ2dlciBhbGFybVxuICBpZiAoIXRlc3RSZXN1bHQuc3VjY2Vzcykge1xuICAgIHRocm93IG5ldyBFcnJvcihgQ2FuYXJ5IHRlc3QgZmFpbGVkOiAke3Rlc3RSZXN1bHQuZXJyb3J9YCk7XG4gIH1cbn07XG4iXX0=